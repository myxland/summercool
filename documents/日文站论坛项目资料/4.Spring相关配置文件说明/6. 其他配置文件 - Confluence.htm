<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- saved from url=(0068)http://b2b-doc.alibaba-inc.com/pages/viewpage.action?pageId=31248781 -->
<HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <TITLE>6. 其他配置文件 - Confluence</TITLE>
            
<META id="confluence-context-path" name="confluence-context-path" content="">
<SCRIPT type="text/javascript">
    // Deprecated global variables. To be removed in a future version of Confluence.
    var contextPath = '';
    var i18n = [];
</SCRIPT>



<!-- include system resources -->
<LINK type="text/css" rel="stylesheet" href="./6. 其他配置文件 - Confluence_files/master.css" title="Confluence Master Stylesheet" media="all">
<LINK type="text/css" rel="stylesheet" href="./6. 其他配置文件 - Confluence_files/wiki-content.css" media="all">
<LINK type="text/css" rel="stylesheet" href="./6. 其他配置文件 - Confluence_files/tabs.css" media="all">
<LINK type="text/css" rel="stylesheet" href="./6. 其他配置文件 - Confluence_files/menu.css" media="all">
<!--[if IE]>
<link type="text/css" rel="stylesheet" href="/s/1322/11/1.0/_/download/resources/confluence.web.resources:master-styles/menu-ie.css" media="all"/>
<![endif]-->
<LINK type="text/css" rel="stylesheet" href="./6. 其他配置文件 - Confluence_files/tables.css" media="all">
<LINK type="text/css" rel="stylesheet" href="./6. 其他配置文件 - Confluence_files/panels.css" media="all">
<!--[if IE]>
<link type="text/css" rel="stylesheet" href="/s/1322/11/1.0/_/download/resources/confluence.web.resources:master-styles/master-ie.css" title="Master-IE" media="all"/>
<![endif]-->
<LINK type="text/css" rel="stylesheet" href="./6. 其他配置文件 - Confluence_files/renderer-macros.css" media="all">
<LINK type="text/css" rel="stylesheet" href="./6. 其他配置文件 - Confluence_files/information-macros.css" media="all">
<LINK type="text/css" rel="stylesheet" href="./6. 其他配置文件 - Confluence_files/layout-macros.css" media="all">
<SCRIPT type="text/javascript" src="./6. 其他配置文件 - Confluence_files/yahoo-dom-event.js"></SCRIPT>
<SCRIPT type="text/javascript" src="./6. 其他配置文件 - Confluence_files/atlassian.js"></SCRIPT>
<SCRIPT type="text/javascript" src="./6. 其他配置文件 - Confluence_files/breadcrumbs.js"></SCRIPT>
<SCRIPT type="text/javascript" src="./6. 其他配置文件 - Confluence_files/atlassian-effects.js"></SCRIPT>

<!-- end system resources -->

    <LINK rel="stylesheet" href="./6. 其他配置文件 - Confluence_files/combined.css" type="text/css">

    <META name="confluence-request-time" content="1254214316486">
<LINK rel="shortcut icon" href="http://b2b-doc.alibaba-inc.com/images/icons/favicon.ico">
<LINK rel="icon" type="image/png" href="http://b2b-doc.alibaba-inc.com/images/icons/favicon.png">


    

    <SCRIPT type="text/javascript">

    function toggleMenu(menuId)
    {
        var visible = toggleVisibility(menuId);
        if (visible)
            setCookie("confluence.leftnav." + menuId, true);
        else
            setCookie("confluence.leftnav.", false);
    }

    function isMenuExpanded(menuId)
    {
        return getCookie("confluence.leftnav." + menuId);
    }

    function initMenuItem(menuId)
    {
        if (document.getElementById(menuId))
        {
            if (isMenuExpanded(menuId) == 'true')
            {
                document.getElementById(menuId).style.display = "block";
            }
            else
            {
                document.getElementById(menuId).style.display = "none";
            }
        }
    }
</SCRIPT>

</HEAD><BODY onload="placeFocus()" id="com-atlassian-confluence">
    


    <SCRIPT type="text/javascript">
        function hideMessage(messageId)
        {
            var message = document.getElementById(messageId)
            message.style.display = "none";
            setCookie(messageId, true);
        }
    </SCRIPT>

        

<DIV id="header">
        <FORM id="quick-search" method="post" action="http://b2b-doc.alibaba-inc.com/dosearchsite.action">
                <FIELDSET>
            <LEGEND>Quick Search</LEGEND>
            <INPUT type="hidden" name="quickSearch" value="true">
                        <INPUT type="hidden" name="searchQuery.spaceKey" value="conf_global">
            <INPUT id="quick-search-query" type="text" accesskey="q" name="searchQuery.queryString" size="25">
            <INPUT id="quick-search-submit" type="submit" value="Search">
        </FIELDSET>
        <FIELDSET class="hidden parameters">
            <INPUT type="hidden" id="quickSearchPlaceholder" value="Search">
        </FIELDSET>
    </FORM>
        
    
    <OL id="breadcrumbs">
                    
        <LI><SPAN>
                                    <A href="http://b2b-doc.alibaba-inc.com/dashboard.action">Dashboard</A>
                </SPAN></LI>
                    
        <LI><SPAN>
         &gt;                             <A href="http://b2b-doc.alibaba-inc.com/display/jcbu">04 JCBU文档</A>
                </SPAN></LI>
                                        <LI id="ellipsis" title="    &hellip;
                    Home
             &gt;         01 日文站项目空间
             &gt;         79 C2J论坛项目
             &gt;         C2J论坛框架文档
        &hellip;"><SPAN>&gt; <STRONG>…</STRONG></SPAN></LI>
                                    
        <LI class="hidden-crumb"><SPAN>
         &gt;                             <A href="http://b2b-doc.alibaba-inc.com/display/jcbu/Home">Home</A>
                </SPAN></LI>
                                
        <LI class="hidden-crumb"><SPAN>
         &gt;                             <A href="http://b2b-doc.alibaba-inc.com/pages/viewpage.action?pageId=9470757">01 日文站项目空间</A>
                </SPAN></LI>
                                
        <LI class="hidden-crumb"><SPAN>
         &gt;                             <A href="http://b2b-doc.alibaba-inc.com/pages/viewpage.action?pageId=22023076">79 C2J论坛项目</A>
                </SPAN></LI>
                                
        <LI class="hidden-crumb"><SPAN>
         &gt;                             <A href="http://b2b-doc.alibaba-inc.com/pages/viewpage.action?pageId=29297881">C2J论坛框架文档</A>
                </SPAN></LI>
                    
        <LI><SPAN>
         &gt;                             <A href="http://b2b-doc.alibaba-inc.com/pages/viewpage.action?pageId=30179439">四、Spring相关配置文件说明</A>
                </SPAN></LI>
                    
        <LI><SPAN>
         &gt;                             6. 其他配置文件
                </SPAN></LI>
        </OL>

</DIV>

<DIV id="PageContent">
    <TABLE cellspacing="0" cellpadding="0" width="100%">
        <TBODY><TR>
                    <TD width="150px" valign="top" class="sidebar" nowrap="">
                <DIV class="leftnav">
                     <DIV id="logodiv">
                        					        					                          </DIV>
                      <DIV id="menu">
                        
                        
<H5><A href="http://b2b-doc.alibaba-inc.com/pages/viewpage.action?pageId=31248781#" onclick="toggleMenu(&#39;pagenav&#39;); return false;"><IMG src="./6. 其他配置文件 - Confluence_files/docs_16.gif" width="16" height="16" border="0" align="absmiddle"> Page Operations</A></H5>
<DIV id="pagenav" class="subnav" style="display: block; ">
   <UL>
	   		   <LI><A id="viewPageLink" href="./6. 其他配置文件 - Confluence_files/6. 其他配置文件 - Confluence.htm" class="current" accesskey="v"><U>V</U>iew</A></LI>
	   		   <LI><A id="editPageLink" href="http://b2b-doc.alibaba-inc.com/pages/editpage.action?pageId=31248781" accesskey="e"><U>E</U>dit</A></LI>
	   		   <LI><A id="view-attachments-link" href="http://b2b-doc.alibaba-inc.com/pages/viewpageattachments.action?pageId=31248781" accesskey="a"><U>A</U>ttachments (2)</A></LI>
	   		   <LI><A id="view-page-info-link" href="http://b2b-doc.alibaba-inc.com/pages/viewinfo.action?pageId=31248781" accesskey="i"><U>I</U>nfo</A></LI>
	      </UL>
</DIV>

                        
                        
<H5><A href="http://b2b-doc.alibaba-inc.com/pages/viewpage.action?pageId=31248781#" onclick="toggleMenu(&#39;browsenav&#39;); return false;"><IMG src="./6. 其他配置文件 - Confluence_files/browse_space.gif" height="16" width="16" border="0" align="absmiddle" title="Find Content"> Browse Space</A></H5>
<DIV id="browsenav" class="subnav" style="display: none; ">
	<UL>
					<LI><A href="http://b2b-doc.alibaba-inc.com/pages/listpages.action?key=jcbu">Pages</A></LI>
					<LI><A href="http://b2b-doc.alibaba-inc.com/pages/viewrecentblogposts.action?key=jcbu">News</A></LI>
					<LI><A href="http://b2b-doc.alibaba-inc.com/labels/listlabels-heatmap.action?key=jcbu">Labels</A></LI>
					<LI><A href="http://b2b-doc.alibaba-inc.com/spaces/listattachmentsforspace.action?key=jcbu">Attachments</A></LI>
					<LI><A href="http://b2b-doc.alibaba-inc.com/spaces/space-bookmarks.action?spaceKey=jcbu">Bookmarks</A></LI>
					<LI><A href="http://b2b-doc.alibaba-inc.com/spaces/viewmailarchive.action?key=jcbu">Mail</A></LI>
					<LI><A href="http://b2b-doc.alibaba-inc.com/spaces/viewspacesummary.action?key=jcbu">Advanced</A></LI>
			</UL>
</DIV>

<H5><A href="http://b2b-doc.alibaba-inc.com/pages/viewpage.action?pageId=31248781#" onclick="toggleMenu(&#39;addcontent&#39;); return false;"><IMG src="./6. 其他配置文件 - Confluence_files/add_16.gif" height="16" width="16" border="0" align="absmiddle" title="Find Content"> Add Content</A></H5>
<DIV id="addcontent" class="subnav" style="display: block; ">
    <UL>
										
									<LI><A href="http://b2b-doc.alibaba-inc.com/pages/createpage.action?spaceKey=jcbu&fromPageId=31248781"><IMG src="./6. 其他配置文件 - Confluence_files/add_page_16.gif" height="16" width="16" border="0" align="absmiddle" title="Add Page">&nbsp;Add Page</A></LI>
						    			</UL>
</DIV>

                      </DIV>
                    <SCRIPT type="text/javascript">
                        initMenuItem("browsenav");
                        initMenuItem("pagenav");
                        initMenuItem("addcontent");
                    </SCRIPT>
                </DIV>
            </TD>
                    <TD valign="top" width="100%">
                <!-- Inner content table -->
                <TABLE width="100%" cellpadding="2" cellspacing="0">
                    <TBODY><TR>
                        <TD colspan="2" valign="middle" align="right" style="background-color:#F0F0F0">
                            
    <UL id="page-view-panel">
        <LI>    <A href="http://b2b-doc.alibaba-inc.com/pages/viewpage.action?pageId=31248781&decorator=printable" rel="nofollow" title="View a printable version of the current page." class="print icon">View a printable version of the current page.</A>
</LI>
                        
                                     </UL>

                                        <UL id="user-control-panel">
                    <LI class="first">Welcome <A href="http://b2b-doc.alibaba-inc.com/display/~shaochuan.wangsc">王少川</A></LI>

                            <LI><A href="http://b2b-doc.alibaba-inc.com/users/viewuserhistory.action" onclick="window.open(this.href,&#39;user_history&#39;, &#39;width=620, height=600, resizable&#39;); return false;" title="View History">History</A></LI>
            
            <LI><A href="http://b2b-doc.alibaba-inc.com/users/viewuserprofile.action?username=shaochuan.wangsc">Preferences</A></LI>

            
            <LI><A href="http://b2b-doc.alibaba-inc.com/logout.action" id="logout">Log Out</A></LI>
                </UL>
                            </TD>
                    </TR>
                    <TR>
                        <TD id="mainViewPane">
                            <DIV>
                                <TABLE class="fullWidthBorderless">
                                    <TBODY><TR><TD><SPAN id="spaceFullNameLink">            <A href="http://b2b-doc.alibaba-inc.com/display/jcbu">04 JCBU文档</A>    </SPAN></TD>
                                    <TD align="right">
    <A id="pageFavourite" href="http://b2b-doc.alibaba-inc.com/labels/addfavourite.action?entityId=31248781"><IMG src="./6. 其他配置文件 - Confluence_files/star_grey.gif" height="16" width="16" border="0" align="absmiddle" title="Add this page to your favourites list" alt="Add this page to your favourites list"></A>
    <A id="pageWatch" href="http://b2b-doc.alibaba-inc.com/spaces/viewspacecontent.action?key=jcbu"><IMG src="./6. 其他配置文件 - Confluence_files/add_space_notification_16.gif" height="16" width="16" border="0" align="absmiddle" title="You are currently watching the 04 JCBU文档 space" alt="You are currently watching the 04 JCBU文档 space"></A>
</TD>
                                </TR></TBODY></TABLE>
                                <H1>
                                                                            <A href="./6. 其他配置文件 - Confluence_files/6. 其他配置文件 - Confluence.htm">6. 其他配置文件</A>
                                    </H1>
                            </DIV>
                                                        <DIV id="content">
                                <!--
    Root decorator: all decisions about how a page is to be decorated via the
                    inline decoration begins here.
-->



<!--
    Switch based upon the context. However, for now, just delegate to a decorator
    identified directly by the context.
-->


    
    <!--[if gte IE 5.5000]>
<script language="JavaScript">
function correctPNG() // correctly handle PNG transparency in Win IE 5.5 or higher.
   {
   for(var i=0; i<document.images.length; i++)
      {
	  var img = document.images[i]
	  var imgName = img.src.toUpperCase()
	  if (imgName.substring(imgName.length-3, imgName.length) == "PNG")
	     {
		 var imgID = (img.id) ? "id='" + img.id + "' " : ""
		 var imgClass = (img.className) ? "class='" + img.className + "' " : ""
		 var imgTitle = (img.title) ? "title='" + img.title + "' " : "title='" + img.alt + "' "
		 var imgStyle = "display:inline-block;" + img.style.cssText
		 if (img.align == "left") imgStyle = "float:left;" + imgStyle
		 if (img.align == "right") imgStyle = "float:right;" + imgStyle
		 if (img.parentElement.href) imgStyle = "cursor:hand;" + imgStyle
		 var strNewHTML = "<span " + imgID + imgClass + imgTitle
		 + " style=\"" + "width:" + img.width + "px; height:" + img.height + "px;" + imgStyle + ";"
	     + "filter:progid:DXImageTransform.Microsoft.AlphaImageLoader"
		 + "(src=\'" + img.src + "\', sizingMethod='scale');\"></span>"
		 img.outerHTML = strNewHTML
		 i = i-1
	     }
      }
   }
window.attachEvent("onload", correctPNG);
</script>
<![endif]-->


































    
<DIV class="smalltext">
                Added by <A href="http://b2b-doc.alibaba-inc.com/display/~shaochuan.wangsc">王少川</A>, last edited by <A href="http://b2b-doc.alibaba-inc.com/display/~shaochuan.wangsc">王少川</A> on Jun 24, 2009
                      &nbsp;(<A class="noprint" href="http://b2b-doc.alibaba-inc.com/pages/diffpages.action?pageId=31248781&originalId=31986856">view change</A>)
              
    
 
<DIV id="labels-section">
    <DIV id="labels-header" class="section-header">
        <H2 class="section-title">Labels</H2>&nbsp;
                <SPAN id="labels-edit-link" class="inline-control-link">
            <A href="" onclick="onAddLabel(); showLabelsInput(); return false;">Edit Labels</A>
        </SPAN>
            </DIV>
    <DIV id="labelsList">
                    (None)
            </DIV>

    <!-- Delay the loading of the external javascript file needed for labels (as it takes too long to load and visibly holds loading of the page body) -->
    <!-- To do this without javascript errors over undefined functions, we need to declare stubs here (that are overrided later by the proper implementations) -->
    <SCRIPT type="text/javascript">
        function doAddLabel(hideTextfieldAfterAddParam)
        {
            // stub
        }

        function onAddLabel()
        {
            // stub
        }

        function showLabelsInput()
        {
            // stub
        }
    </SCRIPT>

    <!-- This is a hack to work around an apparent SiteMesh bug - http://jira.opensymphony.com/browse/SIM-198 -->
    

    <SPAN class="error"><SPAN class="errorMessage" id="errorSpan"></SPAN></SPAN>
    <FORM name="addLabelForm" method="" action="" onsubmit="doAddLabel(false); return false;" style="margin: 0px; padding: 0px">
        <DIV id="labelInputSpan" style="display: none">
            <DIV style="border: 1px solid #cccccc; padding: 8px; background-color: #f0f0f0">

            <DIV id="labelOperationErrorContainer" style="display: none"><SPAN class="error"><SPAN class="errorMessage" id="labelOperationErrorMessage"></SPAN></SPAN></DIV>

            <TABLE width="90%">
                <TBODY><TR>
                    <TD>
                        <DIV class="formtitle" style="padding-bottom: 3px; font-size: 13px;">Add Labels</DIV>
                    </TD>
                    <TD align="right"><DIV id="waitImageAndStatus" style="display: none; height: 16px;"><IMG alt="Wait Image" border="0" align="absmiddle" src="./6. 其他配置文件 - Confluence_files/wait.gif">&nbsp;<SPAN id="labelOperationStatus" class="smalltext" style="vertical-align: middle"></SPAN></DIV></TD>
                </TR>
                <TR><TD width="50%">
                        Enter labels to add to this page:<BR>
            <INPUT autocomplete="off" type="text" id="labelName" name="labelsString" value="" class="monospaceInput" size="40">
            <INPUT type="submit" onclick="doAddLabel(false); return false;" value="Add"><INPUT type="button" onclick="doAddLabel(true); return false;" value="Done">
            <DIV class="auto_complete" id="labelsAutocompleteList" style="display: none; "></DIV>
            <DIV class="smalltext">
                Looking for a label? Just start typing.
            </DIV>
            </TD>
                <TD width="50%" valign="top">
                    <DIV id="suggestedLabelsSpan"></DIV>
                </TD>
            </TR></TBODY></TABLE>
            </DIV>
        </DIV>
    </FORM>
</DIV>
</DIV>


<DIV class="wiki-content" style="margin-right:10px;">
   <!-- wiki content -->
            <H3><A name="6.%E5%85%B6%E4%BB%96%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-1.%E9%A1%B9%E7%9B%AE%E4%B8%AD%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E5%AD%98%E6%94%BE%E4%BD%8D%E7%BD%AE"></A>1.项目中配置文件的存放位置</H3>

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1. 下图为论坛项目工程中配置文件存放的位置：<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <IMG src="./6. 其他配置文件 - Confluence_files/temp2.png" align="absmiddle" border="0"></P>

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color="#660000"><B>说明：</B></FONT>1. 首先，上图中的红色标记为"A"和"B"的两处，就是Maven2项目中存放配置文件的位置。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. 再次，配置文件实际上是存放在classpath下面的，即项目打包时是存放在jar包里面的。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3. 最后，上面的图形只是论坛项目工程的一部分；不过所有的项目工程中的配置文件位置都是一样的。</P>

<H3><A name="6.%E5%85%B6%E4%BB%96%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-2.%E7%9B%B8%E5%85%B3%E9%87%8D%E8%A6%81%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%88%97%E8%A1%A8"></A>2.相关重要的配置文件列表</H3>

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1. web工程相关的配置文件如下：<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1). /WEB-INF/web.xml：web项目中的必要文件。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2). /WEB-INF/club-servlet.xml：因为Spring MVC的DispatcherServlet处理器的名称为：<FONT color="#0000cc"><B>club</B></FONT>，所以项目在启动的时候会自动加载/WEB-INF/<FONT color="#0000cc"><B>club-servlet.xml</B></FONT>；如果该文件不存在，则会抛出异常。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3). /WEB-INF/jboss-web.xml：指定要访问web项目的上下文路径。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4). /WEB-INF/log4j/log4j.xml：log4j的xml形式的配置文件。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /WEB-INF/log4j/log4j.dtd：log4j的xml形式的配置文件的schema。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /WEB-INF/log4j/log4j.properties：log4j的相关设置，包括log等级和log生成路径。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. 框架相关的配置如下：<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1). /WEB-INF/config/config.properties：项目中的配置文件，其中主要包括项目中用到的配置信息。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2). /WEB-INF/config/applicationContext.xml：整个项目的web层的核心配置文件，包括了Spring MVC整个框架的核心配置信息。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3). classpath:/web/common/common-module.xml：整个项目中web层的相关配置，主要是权限处理的相关配置。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4). classpath:/web/common/cookie-configure.xml：整个项目中web层的cookies的设置。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3. 底层服务层的相关配置如下：<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1). classpath:/biz/dal/spring/datasource.xml：项目中DB连接池的配置。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2). classpath:/biz/dal/spring/business-dao.xml：项目中DAO层的相关配置。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3). classpath:/biz/core/spring/common-service.xml：项目中共通Service的相关配置。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4). classpath:/biz/dal/spring/spring-search.xml：项目中搜索引擎的相关配置。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5). classpath:/biz/core/spring/business-service.xml：项目中业务逻辑Service的相关配置。</P>

<H3><A name="6.%E5%85%B6%E4%BB%96%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-3.%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E7%9A%84%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE"></A>3.日志文件的相关配置</H3>

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1. 下面为/WEB-INF/log4j/log4j.xml里面的代码：</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">&lt;?xml version=<SPAN class="code-quote">"1.0"</SPAN> encoding=<SPAN class="code-quote">"UTF-8"</SPAN>?&gt;
&lt;!DOCTYPE log4j:configuration SYSTEM <SPAN class="code-quote">"log4j.dtd"</SPAN>&gt;
&lt;log4j:configuration xmlns:log4j=<SPAN class="code-quote">"http:<SPAN class="code-comment">//jakarta.apache.org/log4j/"</SPAN>&gt;
</SPAN>    &lt;appender name=<SPAN class="code-quote">"ERROR-ALL"</SPAN>
        class=<SPAN class="code-quote">"com.alibaba.common.logging.spi.log4j.DailyRollingFileAppender"</SPAN>&gt;
        &lt;param name=<SPAN class="code-quote">"file"</SPAN> value=<SPAN class="code-quote">"${japan.club.loggingRoot}/all-error.log"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"append"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"encoding"</SPAN> value=<SPAN class="code-quote">"UTF-8"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"threshold"</SPAN> value=<SPAN class="code-quote">"error"</SPAN> /&gt;
        &lt;layout class=<SPAN class="code-quote">"org.apache.log4j.PatternLayout"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"ConversionPattern"</SPAN> value=<SPAN class="code-quote">"%d %-5p %c{2} - %m%n"</SPAN> /&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;
    &lt;appender name=<SPAN class="code-quote">"CLUB-DEBUG"</SPAN>
        class=<SPAN class="code-quote">"com.alibaba.common.logging.spi.log4j.FileAppender"</SPAN>&gt;
        &lt;param name=<SPAN class="code-quote">"file"</SPAN> value=<SPAN class="code-quote">"${japan.club.loggingRoot}/club-debug.log"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"append"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"encoding"</SPAN> value=<SPAN class="code-quote">"UTF-8"</SPAN> /&gt;
        &lt;layout class=<SPAN class="code-quote">"org.apache.log4j.PatternLayout"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"ConversionPattern"</SPAN> value=<SPAN class="code-quote">"%d %-5p %c{2} - %m%n"</SPAN> /&gt;
        &lt;/layout&gt;
        &lt;!--过滤器设置输出的级别，只输出 debug 级别的日志--&gt;
        &lt;filter class=<SPAN class="code-quote">"org.apache.log4j.varia.LevelRangeFilter"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"levelMin"</SPAN> value=<SPAN class="code-quote">"debug"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"levelMax"</SPAN> value=<SPAN class="code-quote">"debug"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"AcceptOnMatch"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;/filter&gt;
    &lt;/appender&gt;
    &lt;appender name=<SPAN class="code-quote">"CLUB-INFO"</SPAN>
        class=<SPAN class="code-quote">"com.alibaba.common.logging.spi.log4j.FileAppender"</SPAN>&gt;
        &lt;param name=<SPAN class="code-quote">"file"</SPAN> value=<SPAN class="code-quote">"${japan.club.loggingRoot}/club-info.log"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"append"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"encoding"</SPAN> value=<SPAN class="code-quote">"UTF-8"</SPAN> /&gt;
        &lt;layout class=<SPAN class="code-quote">"org.apache.log4j.PatternLayout"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"ConversionPattern"</SPAN> value=<SPAN class="code-quote">"%d %-5p %c{2} - %m%n"</SPAN> /&gt;
        &lt;/layout&gt;
        &lt;!--过滤器设置输出的级别 warn info --&gt;
        &lt;filter class=<SPAN class="code-quote">"org.apache.log4j.varia.LevelRangeFilter"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"levelMin"</SPAN> value=<SPAN class="code-quote">"info"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"levelMax"</SPAN> value=<SPAN class="code-quote">"warn"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"AcceptOnMatch"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;/filter&gt;

    &lt;/appender&gt;
    &lt;appender name=<SPAN class="code-quote">"HOME-DEBUG"</SPAN>
        class=<SPAN class="code-quote">"com.alibaba.common.logging.spi.log4j.FileAppender"</SPAN>&gt;
        &lt;param name=<SPAN class="code-quote">"file"</SPAN> value=<SPAN class="code-quote">"${japan.club.loggingRoot}/home-debug.log"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"append"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"encoding"</SPAN> value=<SPAN class="code-quote">"UTF-8"</SPAN> /&gt;
        &lt;layout class=<SPAN class="code-quote">"org.apache.log4j.PatternLayout"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"ConversionPattern"</SPAN> value=<SPAN class="code-quote">"%d %-5p %c{2} - %m%n"</SPAN> /&gt;
        &lt;/layout&gt;
        &lt;!--过滤器设置输出的级别--&gt;
        &lt;filter class=<SPAN class="code-quote">"org.apache.log4j.varia.LevelRangeFilter"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"levelMin"</SPAN> value=<SPAN class="code-quote">"debug"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"levelMax"</SPAN> value=<SPAN class="code-quote">"debug"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"AcceptOnMatch"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;/filter&gt;
    &lt;/appender&gt;
    &lt;appender name=<SPAN class="code-quote">"HOME-INFO"</SPAN>
        class=<SPAN class="code-quote">"com.alibaba.common.logging.spi.log4j.FileAppender"</SPAN>&gt;
        &lt;param name=<SPAN class="code-quote">"file"</SPAN> value=<SPAN class="code-quote">"${japan.club.loggingRoot}/home-info.log"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"append"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"encoding"</SPAN> value=<SPAN class="code-quote">"UTF-8"</SPAN> /&gt;
        &lt;layout class=<SPAN class="code-quote">"org.apache.log4j.PatternLayout"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"ConversionPattern"</SPAN> value=<SPAN class="code-quote">"%d %-5p %c{2} - %m%n"</SPAN> /&gt;
        &lt;/layout&gt;
        &lt;!--过滤器设置输出的级别 warn info --&gt;
        &lt;filter class=<SPAN class="code-quote">"org.apache.log4j.varia.LevelRangeFilter"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"levelMin"</SPAN> value=<SPAN class="code-quote">"info"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"levelMax"</SPAN> value=<SPAN class="code-quote">"warn"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"AcceptOnMatch"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;/filter&gt;
    &lt;/appender&gt;
    &lt;appender name=<SPAN class="code-quote">"HOME-ERROR"</SPAN>
        class=<SPAN class="code-quote">"com.alibaba.common.logging.spi.log4j.DailyRollingFileAppender"</SPAN>&gt;
        &lt;param name=<SPAN class="code-quote">"file"</SPAN> value=<SPAN class="code-quote">"${japan.club.loggingRoot}/home-error.log"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"append"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"encoding"</SPAN> value=<SPAN class="code-quote">"UTF-8"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"threshold"</SPAN> value=<SPAN class="code-quote">"error"</SPAN> /&gt;
        &lt;layout class=<SPAN class="code-quote">"org.apache.log4j.PatternLayout"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"ConversionPattern"</SPAN> value=<SPAN class="code-quote">"%d %-5p %c{2} - %m%n"</SPAN> /&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;
    &lt;appender name=<SPAN class="code-quote">"ADMIN-DEBUG"</SPAN>
        class=<SPAN class="code-quote">"com.alibaba.common.logging.spi.log4j.FileAppender"</SPAN>&gt;
        &lt;param name=<SPAN class="code-quote">"file"</SPAN> value=<SPAN class="code-quote">"${japan.club.loggingRoot}/admin-debug.log"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"append"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"encoding"</SPAN> value=<SPAN class="code-quote">"UTF-8"</SPAN> /&gt;
        &lt;layout class=<SPAN class="code-quote">"org.apache.log4j.PatternLayout"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"ConversionPattern"</SPAN> value=<SPAN class="code-quote">"%d %-5p %c{2} - %m%n"</SPAN> /&gt;
        &lt;/layout&gt;
        &lt;!--过滤器设置输出的级别--&gt;
        &lt;filter class=<SPAN class="code-quote">"org.apache.log4j.varia.LevelRangeFilter"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"levelMin"</SPAN> value=<SPAN class="code-quote">"debug"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"levelMax"</SPAN> value=<SPAN class="code-quote">"debug"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"AcceptOnMatch"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;/filter&gt;
    &lt;/appender&gt;
    &lt;appender name=<SPAN class="code-quote">"ADMIN-INFO"</SPAN>
        class=<SPAN class="code-quote">"com.alibaba.common.logging.spi.log4j.FileAppender"</SPAN>&gt;
        &lt;param name=<SPAN class="code-quote">"file"</SPAN> value=<SPAN class="code-quote">"${japan.club.loggingRoot}/admin-info.log"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"append"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"encoding"</SPAN> value=<SPAN class="code-quote">"UTF-8"</SPAN> /&gt;
        &lt;layout class=<SPAN class="code-quote">"org.apache.log4j.PatternLayout"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"ConversionPattern"</SPAN> value=<SPAN class="code-quote">"%d %-5p %c{2} - %m%n"</SPAN> /&gt;
        &lt;/layout&gt;
        &lt;!--过滤器设置输出的级别 warn info --&gt;
        &lt;filter class=<SPAN class="code-quote">"org.apache.log4j.varia.LevelRangeFilter"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"levelMin"</SPAN> value=<SPAN class="code-quote">"info"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"levelMax"</SPAN> value=<SPAN class="code-quote">"warn"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"AcceptOnMatch"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;/filter&gt;

    &lt;/appender&gt;
    &lt;appender name=<SPAN class="code-quote">"ADMIN-ERROR"</SPAN>
        class=<SPAN class="code-quote">"com.alibaba.common.logging.spi.log4j.DailyRollingFileAppender"</SPAN>&gt;
        &lt;param name=<SPAN class="code-quote">"file"</SPAN> value=<SPAN class="code-quote">"${japan.club.loggingRoot}/admin-error.log"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"append"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"encoding"</SPAN> value=<SPAN class="code-quote">"UTF-8"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"threshold"</SPAN> value=<SPAN class="code-quote">"error"</SPAN> /&gt;
        &lt;layout class=<SPAN class="code-quote">"org.apache.log4j.PatternLayout"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"ConversionPattern"</SPAN> value=<SPAN class="code-quote">"%d %-5p %c{2} - %m%n"</SPAN> /&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;
    &lt;appender name=<SPAN class="code-quote">"DAO-DEBUG"</SPAN>
        class=<SPAN class="code-quote">"com.alibaba.common.logging.spi.log4j.DailyRollingFileAppender"</SPAN>&gt;
        &lt;param name=<SPAN class="code-quote">"file"</SPAN> value=<SPAN class="code-quote">"${japan.club.loggingRoot}/dao-debug.log"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"append"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"encoding"</SPAN> value=<SPAN class="code-quote">"UTF-8"</SPAN> /&gt;
        &lt;layout class=<SPAN class="code-quote">"org.apache.log4j.PatternLayout"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"ConversionPattern"</SPAN> value=<SPAN class="code-quote">"%d %-5p %c{2} - %m%n"</SPAN> /&gt;
        &lt;/layout&gt;
        &lt;!--过滤器设置输出的级别 只记录 debug 级别的日志信息 --&gt;
        &lt;filter class=<SPAN class="code-quote">"org.apache.log4j.varia.LevelRangeFilter"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"levelMin"</SPAN> value=<SPAN class="code-quote">"debug"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"levelMax"</SPAN> value=<SPAN class="code-quote">"debug"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"AcceptOnMatch"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;/filter&gt;
    &lt;/appender&gt;
    &lt;appender name=<SPAN class="code-quote">"DAO-INFO"</SPAN>
        class=<SPAN class="code-quote">"com.alibaba.common.logging.spi.log4j.DailyRollingFileAppender"</SPAN>&gt;
        &lt;param name=<SPAN class="code-quote">"file"</SPAN> value=<SPAN class="code-quote">"${japan.club.loggingRoot}/dao-info.log"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"append"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"encoding"</SPAN> value=<SPAN class="code-quote">"UTF-8"</SPAN> /&gt;
        &lt;layout class=<SPAN class="code-quote">"org.apache.log4j.PatternLayout"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"ConversionPattern"</SPAN> value=<SPAN class="code-quote">"%d %-5p %c{2} - %m%n"</SPAN> /&gt;
        &lt;/layout&gt;
        &lt;!--过滤器设置输出的级别 记录 warn info 这两个级别的日志信息 --&gt;
        &lt;filter class=<SPAN class="code-quote">"org.apache.log4j.varia.LevelRangeFilter"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"levelMin"</SPAN> value=<SPAN class="code-quote">"info"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"levelMax"</SPAN> value=<SPAN class="code-quote">"warn"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"AcceptOnMatch"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;/filter&gt;
    &lt;/appender&gt;
    &lt;appender name=<SPAN class="code-quote">"DAO-ERROR"</SPAN>
        class=<SPAN class="code-quote">"com.alibaba.common.logging.spi.log4j.DailyRollingFileAppender"</SPAN>&gt;
        &lt;param name=<SPAN class="code-quote">"file"</SPAN> value=<SPAN class="code-quote">"${japan.club.loggingRoot}/dao-error.log"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"append"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"encoding"</SPAN> value=<SPAN class="code-quote">"UTF-8"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"threshold"</SPAN> value=<SPAN class="code-quote">"error"</SPAN> /&gt;
        &lt;layout class=<SPAN class="code-quote">"org.apache.log4j.PatternLayout"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"ConversionPattern"</SPAN> value=<SPAN class="code-quote">"%d %-5p %c{2} - %m%n"</SPAN> /&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;
    &lt;appender name=<SPAN class="code-quote">"SERVICE-DEBUG"</SPAN>
        class=<SPAN class="code-quote">"com.alibaba.common.logging.spi.log4j.DailyRollingFileAppender"</SPAN>&gt;
        &lt;param name=<SPAN class="code-quote">"file"</SPAN> value=<SPAN class="code-quote">"${japan.club.loggingRoot}/service-debug.log"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"append"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"encoding"</SPAN> value=<SPAN class="code-quote">"UTF-8"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"threshold"</SPAN> value=<SPAN class="code-quote">"debug"</SPAN> /&gt;
        &lt;layout class=<SPAN class="code-quote">"org.apache.log4j.PatternLayout"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"ConversionPattern"</SPAN> value=<SPAN class="code-quote">"%d %-5p %c{2} - %m%n"</SPAN> /&gt;
        &lt;/layout&gt;
        &lt;!--过滤器设置输出的级别 warn info--&gt;
        &lt;filter class=<SPAN class="code-quote">"org.apache.log4j.varia.LevelRangeFilter"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"levelMin"</SPAN> value=<SPAN class="code-quote">"debug"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"levelMax"</SPAN> value=<SPAN class="code-quote">"debug"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"AcceptOnMatch"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;/filter&gt;
    &lt;/appender&gt;
    &lt;appender name=<SPAN class="code-quote">"SERVICE-INFO"</SPAN>
        class=<SPAN class="code-quote">"com.alibaba.common.logging.spi.log4j.DailyRollingFileAppender"</SPAN>&gt;
        &lt;param name=<SPAN class="code-quote">"file"</SPAN> value=<SPAN class="code-quote">"${japan.club.loggingRoot}/service-info.log"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"append"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"encoding"</SPAN> value=<SPAN class="code-quote">"UTF-8"</SPAN> /&gt;
        &lt;layout class=<SPAN class="code-quote">"org.apache.log4j.PatternLayout"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"ConversionPattern"</SPAN> value=<SPAN class="code-quote">"%d %-5p %c{2} - %m%n"</SPAN> /&gt;
        &lt;/layout&gt;
        &lt;!--过滤器设置输出的级别 warn info--&gt;
        &lt;filter class=<SPAN class="code-quote">"org.apache.log4j.varia.LevelRangeFilter"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"levelMin"</SPAN> value=<SPAN class="code-quote">"info"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"levelMax"</SPAN> value=<SPAN class="code-quote">"warn"</SPAN> /&gt;
            &lt;param name=<SPAN class="code-quote">"AcceptOnMatch"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;/filter&gt;
    &lt;/appender&gt;
    &lt;appender name=<SPAN class="code-quote">"SERVICE-ERROR"</SPAN>
        class=<SPAN class="code-quote">"com.alibaba.common.logging.spi.log4j.DailyRollingFileAppender"</SPAN>&gt;
        &lt;param name=<SPAN class="code-quote">"file"</SPAN> value=<SPAN class="code-quote">"${japan.club.loggingRoot}/service-error.log"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"append"</SPAN> value=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"encoding"</SPAN> value=<SPAN class="code-quote">"UTF-8"</SPAN> /&gt;
        &lt;param name=<SPAN class="code-quote">"threshold"</SPAN> value=<SPAN class="code-quote">"error"</SPAN> /&gt;
        &lt;layout class=<SPAN class="code-quote">"org.apache.log4j.PatternLayout"</SPAN>&gt;
            &lt;param name=<SPAN class="code-quote">"ConversionPattern"</SPAN> value=<SPAN class="code-quote">"%d %-5p %c{2} - %m%n"</SPAN> /&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;
    &lt;!-- =====================================================================    --&gt;
    &lt;!-- Home 日志                                                                --&gt;
    &lt;!-- =====================================================================     --&gt;

    &lt;logger name=<SPAN class="code-quote">"com.alibaba.japan.club.web.module.home"</SPAN> additivity=<SPAN class="code-quote">"<SPAN class="code-keyword">false</SPAN>"</SPAN>&gt;
        &lt;level value=<SPAN class="code-quote">"${japan.club.loggingLevel}"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"HOME-DEBUG"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"HOME-INFO"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"HOME-ERROR"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"ERROR-ALL"</SPAN> /&gt;
    &lt;/logger&gt;
    &lt;!-- ===================================================================== --&gt;
    &lt;!-- Admin 日志                                                               --&gt;
    &lt;!-- ===================================================================== --&gt;

    &lt;logger name=<SPAN class="code-quote">"com.alibaba.japan.club.web.module.admin"</SPAN> additivity=<SPAN class="code-quote">"<SPAN class="code-keyword">false</SPAN>"</SPAN>&gt;
        &lt;level value=<SPAN class="code-quote">"${japan.club.loggingLevel}"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"ADMIN-DEBUG"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"ADMIN-INFO"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"ADMIN-ERROR"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"ERROR-ALL"</SPAN> /&gt;
    &lt;/logger&gt;
    &lt;!-- ===================================================================== --&gt;
    &lt;!-- Service 日志                                                           --&gt;
    &lt;!-- ===================================================================== --&gt;

    &lt;logger name=<SPAN class="code-quote">"com.alibaba.japan.club.biz.core"</SPAN> additivity=<SPAN class="code-quote">"<SPAN class="code-keyword">false</SPAN>"</SPAN>&gt;
        &lt;level value=<SPAN class="code-quote">"${japan.club.loggingLevel}"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"SERVICE-DEBUG"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"SERVICE-INFO"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"SERVICE-ERROR"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"ERROR-ALL"</SPAN> /&gt;
    &lt;/logger&gt;
    &lt;!-- ===================================================================== --&gt;
    &lt;!-- DAO 日志                                                               --&gt;
    &lt;!-- ===================================================================== --&gt;
    &lt;logger name=<SPAN class="code-quote">"com.alibaba.japan.club.biz.dal"</SPAN> additivity=<SPAN class="code-quote">"<SPAN class="code-keyword">false</SPAN>"</SPAN>&gt;
        &lt;level value=<SPAN class="code-quote">"${japan.club.loggingLevel}"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"DAO-DEBUG"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"DAO-INFO"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"DAO-ERROR"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"ERROR-ALL"</SPAN> /&gt;
    &lt;/logger&gt;
    &lt;!-- ===================================================================== --&gt;
    &lt;!-- ibatis 日志                                                               --&gt;
    &lt;!-- ===================================================================== --&gt;
    &lt;logger name=<SPAN class="code-quote">"com.ibatis"</SPAN> additivity=<SPAN class="code-quote">"<SPAN class="code-keyword">false</SPAN>"</SPAN>&gt;
        &lt;level value=<SPAN class="code-quote">"${japan.club.loggingLevel}"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"DAO-DEBUG"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"DAO-INFO"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"DAO-ERROR"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"ERROR-ALL"</SPAN> /&gt;
    &lt;/logger&gt;
    &lt;!-- ===================================================================== --&gt;
    &lt;!-- sql 日志                                                               --&gt;
    &lt;!-- ===================================================================== --&gt;
    &lt;logger name=<SPAN class="code-quote">"java.sql"</SPAN> additivity=<SPAN class="code-quote">"<SPAN class="code-keyword">false</SPAN>"</SPAN>&gt;
        &lt;level value=<SPAN class="code-quote">"${japan.club.loggingLevel}"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"DAO-DEBUG"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"DAO-INFO"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"DAO-ERROR"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"ERROR-ALL"</SPAN> /&gt;
    &lt;/logger&gt;
    &lt;!-- ===================================================================== --&gt;
    &lt;!-- Root logger 记录配置 --&gt;
    &lt;!-- ===================================================================== --&gt;
    &lt;root&gt;
        &lt;level value=<SPAN class="code-quote">"${japan.club.loggingLevel}"</SPAN> /&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"CLUB-DEBUG"</SPAN> /&gt;    &lt;!-- 其他的调试信息 --&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"CLUB-INFO"</SPAN> /&gt;    &lt;!-- 其他的 warn info 信息 --&gt;
        &lt;appender-ref ref=<SPAN class="code-quote">"ERROR-ALL"</SPAN> /&gt;    &lt;!-- 所有的错误信息   --&gt;
    &lt;/root&gt;
&lt;/log4j:configuration&gt;</PRE>
</DIV></DIV>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color="#660000"><B>说明：</B></FONT>1. 首先，通过上面的配置可以看出，日志的生成路径和级别是通过配置文件的内容注入进来的。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. 再次，日志文件是跟据模块文件产生的。</P>

<H3><A name="6.%E5%85%B6%E4%BB%96%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-4.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0%28DataSource%29%E7%9A%84%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE"></A>4.数据库连接池(DataSource)的相关配置</H3>

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1. 下面为classpath:/biz/dal/spring/datasource.xml文件中DataSource的配置代码如下：</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">&lt;!-- ======================================================================== --&gt;
&lt;!--  DataSource定义。                                                         --&gt;
&lt;!-- ======================================================================== --&gt;

&lt;bean id=<SPAN class="code-quote">"dataSource"</SPAN> class=<SPAN class="code-quote">"org.apache.commons.dbcp.BasicDataSource"</SPAN> destroy-method=<SPAN class="code-quote">"close"</SPAN>&gt;
    &lt;property name=<SPAN class="code-quote">"driverClassName"</SPAN> value=<SPAN class="code-quote">"oracle.jdbc.driver.OracleDriver"</SPAN>/&gt;
    &lt;property name=<SPAN class="code-quote">"url"</SPAN> value=<SPAN class="code-quote">"jdbc:oracle:thin:@10.20.133.197:1521:japdev"</SPAN>/&gt;
    &lt;property name=<SPAN class="code-quote">"username"</SPAN> value=<SPAN class="code-quote">"japan"</SPAN>/&gt;
    &lt;property name=<SPAN class="code-quote">"password"</SPAN> value=<SPAN class="code-quote">"japan"</SPAN>/&gt;
&lt;/bean&gt;</PRE>
</DIV></DIV>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color="#660000"><B>说明：</B></FONT>1. 首先，在开发环境中，DB连接池是通过上面的配置方式进行数据库访问的。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. 再次，如果要是在生成环境中，就会采用JBOSS数据库连接池（JNDI）的方式进行访问的。</P>

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. 生产环境中DataSource的配置代码如下：</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">&lt;bean id=<SPAN class="code-quote">"dataSource"</SPAN> class=<SPAN class="code-quote">"org.springframework.jndi.JndiObjectFactoryBean"</SPAN> <SPAN class="code-keyword">abstract</SPAN>=<SPAN class="code-quote">"<SPAN class="code-keyword">false</SPAN>"</SPAN> singleton=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN>
    lazy-init=<SPAN class="code-quote">"<SPAN class="code-keyword">default</SPAN>"</SPAN> autowire=<SPAN class="code-quote">"<SPAN class="code-keyword">default</SPAN>"</SPAN> dependency-check=<SPAN class="code-quote">"<SPAN class="code-keyword">default</SPAN>"</SPAN>&gt;
    &lt;property name=<SPAN class="code-quote">"jndiName"</SPAN>&gt;
        &lt;value&gt;java:shinkansenDataSource&lt;/value&gt;
    &lt;/property&gt;
&lt;/bean&gt;</PRE>
</DIV></DIV>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color="#660000"><B>说明：</B></FONT>1. 首先，设置生产环境的JBOSS数据库连接池：shinkansenDataSource。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. 再次，在发布生成环境时，将数据库连接池的配置用脚本替换成JNDI的数据库连池方式，如上面代码。</P>

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3. 生产环境中JBOSS的JNDI数据库连接池的配置(oracle-ds.xml)代码如下：</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">&lt;?xml version=<SPAN class="code-quote">"1.0"</SPAN> encoding=<SPAN class="code-quote">"UTF-8"</SPAN>?&gt;
&lt;datasources&gt;
    &lt;local-tx-datasource&gt;
        &lt;jndi-name&gt;shinkansenDataSource&lt;/jndi-name&gt;
        &lt;connection-url&gt;jdbc:oracle:thin:@IP:PORT:SID&lt;/connection-url&gt;
        &lt;connection-property name=<SPAN class="code-quote">"SetBigStringTryClob"</SPAN>&gt;<SPAN class="code-keyword">true</SPAN>&lt;/connection-property&gt;
        &lt;connection-property name=<SPAN class="code-quote">"defaultRowPrefetch"</SPAN>&gt;50&lt;/connection-property&gt;
        &lt;driver-class&gt;oracle.jdbc.driver.OracleDriver&lt;/driver-class&gt;

        &lt;min-pool-size&gt;10&lt;/min-pool-size&gt;
        &lt;max-pool-size&gt;10&lt;/max-pool-size&gt;
        &lt;blocking-timeout-millis&gt;5000&lt;/blocking-timeout-millis&gt;
        &lt;idle-timeout-minutes&gt;60&lt;/idle-timeout-minutes&gt;
        &lt;max-idle-timeout&gt;120&lt;/max-idle-timeout&gt;
        &lt;prepared-statement-cache-size&gt;50&lt;/prepared-statement-cache-size&gt;
        &lt;metadata&gt;
            &lt;type-mapping&gt;Oracle9i&lt;/type-mapping&gt;
        &lt;/metadata&gt;
        &lt;exception-sorter-class-name&gt;org.jboss.resource.adapter.jdbc.vendor.OracleExceptionSorter&lt;/exception-sorter-class-name&gt;
        &lt;!-- sql to call when connection is created --&gt;
        &lt;<SPAN class="code-keyword">new</SPAN>-connection-sql&gt;{ select 1 from dual }&lt;/<SPAN class="code-keyword">new</SPAN>-connection-sql&gt;

        &lt;user-name&gt;数据库用户名&lt;/user-name&gt;
        &lt;password&gt;数据库密码&lt;/password&gt;
    &lt;/local-tx-datasource&gt;
&lt;/datasources&gt;</PRE>
</DIV></DIV>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color="#660000"><B>说明：</B></FONT>1. 首先，JNDI的数据源名称为：shinkansenDataSource。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. 再次，&lt;connection-url&gt;jdbc:oracle:thin:@IP:PORT:SID&lt;/connection-url&gt;：数据库连接的URL，如下：<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1). jdbc:oracle:thin:@10.0.33.46:1521:japdev<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3. 最后，下面为连接数据库时用到的用户名和密码，如下：<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1). &lt;user-name&gt;数据库用户名&lt;/user-name&gt;：&lt;user-name&gt;japan&lt;/user-name&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2). &lt;password&gt;数据库密码&lt;/password&gt;：&lt;password&gt;japan&lt;/password&gt;</P>

<P>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4. 在正式环境上，oracle-ds.xml的存放在下面三个位置：<BR>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1). /home/admin/bops/conf/oracle-ds.xml：正式环境上面的oracle数据库连接池的配置文件，只是当模版使用。<BR>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2). /home/admin/.myjboss/deploy/oracle-ds.xml：正式环境运行时用到的数据库连接池配置文件，是通过上面的模版文件拷备过来的。</P>

<H3><A name="6.%E5%85%B6%E4%BB%96%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-5.%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1%E7%9A%84%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE"></A>5.数据库事务的相关配置</H3>

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1. 下面为classpath:/biz/dal/spring/datasource.xml文件中transactionManager的配置代码如下：</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">&lt;!--  TransactionManager定义。                                                --&gt;
&lt;!-- ======================================================================== --&gt;
&lt;bean id=<SPAN class="code-quote">"transactionManager"</SPAN> class=<SPAN class="code-quote">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</SPAN>&gt;
    &lt;property name=<SPAN class="code-quote">"dataSource"</SPAN> ref=<SPAN class="code-quote">"dataSource"</SPAN> /&gt;
&lt;/bean&gt;
&lt;bean id=<SPAN class="code-quote">"transactionTemplate"</SPAN> class=<SPAN class="code-quote">"org.springframework.transaction.support.TransactionTemplate"</SPAN>&gt;
    &lt;property name=<SPAN class="code-quote">"transactionManager"</SPAN> ref=<SPAN class="code-quote">"transactionManager"</SPAN> /&gt;
&lt;/bean&gt;</PRE>
</DIV></DIV>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. 下面为classpath:/biz/core/spring/business-service.xml文件中事务的配置代码如下：</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">&lt;tx:advice id=<SPAN class="code-quote">"txAdvice"</SPAN> transaction-manager=<SPAN class="code-quote">"transactionManager"</SPAN>&gt;
    &lt;tx:attributes&gt;
        &lt;tx:method name=<SPAN class="code-quote">"update*"</SPAN> propagation=<SPAN class="code-quote">"REQUIRED"</SPAN> /&gt;
        &lt;tx:method name=<SPAN class="code-quote">"insert*"</SPAN> propagation=<SPAN class="code-quote">"REQUIRED"</SPAN> /&gt;
        &lt;tx:method name=<SPAN class="code-quote">"add*"</SPAN> propagation=<SPAN class="code-quote">"REQUIRED"</SPAN> /&gt;
        &lt;tx:method name=<SPAN class="code-quote">"delete*"</SPAN> propagation=<SPAN class="code-quote">"REQUIRED"</SPAN> /&gt;
        &lt;tx:method name=<SPAN class="code-quote">"*"</SPAN> read-only=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
    &lt;/tx:attributes&gt;
&lt;/tx:advice&gt;
&lt;aop:config&gt;
    &lt;!-- 事务管理 --&gt;
    &lt;aop:pointcut id=<SPAN class="code-quote">"serviceOperation"</SPAN> expression=<SPAN class="code-quote">"execution(* com.alibaba.japan.club.biz.core.service..*ServiceImpl.*(..))"</SPAN> /&gt;
    &lt;aop:advisor advice-ref=<SPAN class="code-quote">"txAdvice"</SPAN> pointcut-ref=<SPAN class="code-quote">"serviceOperation"</SPAN> /&gt;
&lt;/aop:config&gt;</PRE>
</DIV></DIV>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color="#660000"><B>说明：</B></FONT>1. 首先，"transactionManager"元素定义了事务管理器是由Spring框架提供的事务管理器。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. 再次，"txAdvice"元素定义了<FONT color="#0000cc"><B>"事务切入点"</B></FONT>；<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1). 以"update"、"insert"、"add"和"delete"方法开头的函数，事务级别都设置为<FONT color="#0000cc"><B>"REQUIRED"</B></FONT>。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2). 其余的所有方法都是只读事务。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3). 切记，事务是可以传播的。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3. 最后，"&lt;aop:config&gt;"元素将切入点织入到com.alibaba.japan.club.biz.core.service包下面所有的以ServiceImpl为结尾的类的所有方法。</P>

<H3><A name="6.%E5%85%B6%E4%BB%96%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-6.Service%E5%8F%8ADao%E7%9A%84%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE"></A>6.Service及Dao的日志相关配置</H3>

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1. 下面为classpath:/biz/core/spring/business-service.xml文件中日志的配置代码如下：</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">&lt;!-- 日志切面 --&gt;
&lt;bean id=<SPAN class="code-quote">"serviceLogAspect"</SPAN> class=<SPAN class="code-quote">"com.alibaba.japan.club.biz.core.log.Log4jAspect"</SPAN>&gt;
&lt;/bean&gt;
&lt;aop:config&gt;
    &lt;!-- 日志管理 --&gt;
    &lt;aop:aspect id=<SPAN class="code-quote">"bizServiceLogAspect"</SPAN> ref=<SPAN class="code-quote">"serviceLogAspect"</SPAN>&gt;
        &lt;aop:pointcut id=<SPAN class="code-quote">"biz-service-log"</SPAN> expression=<SPAN class="code-quote">"execution(* com.alibaba.japan.club.biz.core.service..*ServiceImpl.*(..))"</SPAN> /&gt;
        &lt;aop:before pointcut-ref=<SPAN class="code-quote">"biz-service-log"</SPAN> method=<SPAN class="code-quote">"beforeAdvice"</SPAN> /&gt;
        &lt;aop:after pointcut-ref=<SPAN class="code-quote">"biz-service-log"</SPAN> method=<SPAN class="code-quote">"afterAdvice"</SPAN> /&gt;
    &lt;/aop:aspect&gt;
&lt;/aop:config&gt;</PRE>
</DIV></DIV>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. Log4jAspect代码如下：</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java"><SPAN class="code-keyword">package</SPAN> com.alibaba.japan.club.biz.core.log;

<SPAN class="code-keyword">import</SPAN> org.apache.log4j.Logger;
<SPAN class="code-keyword">import</SPAN> org.aspectj.lang.JoinPoint;

/**
 *
 * @author:shaochuan.wangsc
 * @date:2009-3-27
 *
 */
<SPAN class="code-keyword">public</SPAN> class Log4jAspect {

    <SPAN class="code-keyword">public</SPAN> void beforeAdvice(JoinPoint jp) {
        Logger logger = Logger.getLogger(jp.getTarget().getClass());
        StringBuilder sb = <SPAN class="code-keyword">new</SPAN> StringBuilder();
        <SPAN class="code-object">Object</SPAN>[] objects = jp.getArgs();
        <SPAN class="code-keyword">if</SPAN> (objects != <SPAN class="code-keyword">null</SPAN>) {
            <SPAN class="code-keyword">for</SPAN> (<SPAN class="code-object">Object</SPAN> object : objects) {
                sb.append(<SPAN class="code-quote">"["</SPAN> + object + <SPAN class="code-quote">"]"</SPAN>);
            }
        }
        <SPAN class="code-keyword">if</SPAN> (logger.isDebugEnabled()) {
            logger.debug(<SPAN class="code-quote">"####################################### "</SPAN> + jp.getSignature().getName() + <SPAN class="code-quote">" start... :"</SPAN> + sb.toString());
        }
    }

    <SPAN class="code-keyword">public</SPAN> void afterAdvice(JoinPoint jp) {
        Logger logger = Logger.getLogger(jp.getTarget().getClass());
        <SPAN class="code-keyword">if</SPAN> (logger.isDebugEnabled()) {
            logger.debug(<SPAN class="code-quote">"####################################### "</SPAN> + jp.getSignature().getName() + <SPAN class="code-quote">" end... :"</SPAN>);
        }
    }
}</PRE>
</DIV></DIV>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color="#660000"><B>说明：</B></FONT>1. 首先，"serviceLogAspect"元素定义了日志的<FONT color="#0000cc"><B>"切入点"</B></FONT>。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. 再次，"&lt;aop:config&gt;"元素将切入点织入到com.alibaba.japan.club.biz.core.service包下面所有的以ServiceImpl为结尾的类的所有方法。<BR>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3. 最后，在项目运行时，如果log4j的等级为debug级别的，则会输出相应的Service日志信息，包括调用的方法名及方法参数等。</P>

<H3><A name="6.%E5%85%B6%E4%BB%96%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-7.Spring%E4%B8%8EIbatis%E9%9B%86%E6%88%90%E7%9A%84%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE"></A>7.Spring与Ibatis集成的相关配置</H3>

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1. 下面为classpath:/biz/dal/spring/datasource.xml文件中"iBatis SQL map定义"的配置代码如下：</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">&lt;!-- ======================================================================== --&gt;
&lt;!--  iBatis SQL map定义。                                                    --&gt;
&lt;!-- ======================================================================== --&gt;
&lt;bean id=<SPAN class="code-quote">"sqlMapClient"</SPAN> class=<SPAN class="code-quote">"org.springframework.orm.ibatis.SqlMapClientFactoryBean"</SPAN>&gt;
    &lt;property name=<SPAN class="code-quote">"dataSource"</SPAN> ref=<SPAN class="code-quote">"dataSource"</SPAN> /&gt;
    &lt;property name=<SPAN class="code-quote">"configLocation"</SPAN> value=<SPAN class="code-quote">"classpath:/biz/dal/spring/sqlmap-config.xml"</SPAN> /&gt;
&lt;/bean&gt;</PRE>
</DIV></DIV>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. 下面为classpath:/biz/dal/spring/sqlmap-config.xml的配置代码如下：</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">&lt;?xml version=<SPAN class="code-quote">"1.0"</SPAN> encoding=<SPAN class="code-quote">"UTF-8"</SPAN> standalone=<SPAN class="code-quote">"no"</SPAN>?&gt;
&lt;!DOCTYPE sqlMapConfig PUBLIC <SPAN class="code-quote">"-<SPAN class="code-comment">//iBATIS.com//DTD SQL Map Config 2.0//EN"</SPAN> <SPAN class="code-quote">"http://ibatis.apache.org/dtd/sql-map-config-2.dtd"</SPAN>&gt;
</SPAN>&lt;sqlMapConfig&gt;
    &lt;settings cacheModelsEnabled=<SPAN class="code-quote">"<SPAN class="code-keyword">false</SPAN>"</SPAN> enhancementEnabled=<SPAN class="code-quote">"<SPAN class="code-keyword">false</SPAN>"</SPAN> lazyLoadingEnabled=<SPAN class="code-quote">"<SPAN class="code-keyword">false</SPAN>"</SPAN> maxRequests=<SPAN class="code-quote">"300"</SPAN>
        maxSessions=<SPAN class="code-quote">"100"</SPAN> maxTransactions=<SPAN class="code-quote">"30"</SPAN> useStatementNamespaces=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN> /&gt;
    &lt;sqlMap resource=<SPAN class="code-quote">"com/alibaba/japan/club/biz/dal/dao/type/dataobject/type-mapping.xml"</SPAN> /&gt;
    &lt;sqlMap resource=<SPAN class="code-quote">"com/alibaba/japan/club/biz/dal/dao/category/dataobject/category-mapping.xml"</SPAN> /&gt;
    &lt;sqlMap resource=<SPAN class="code-quote">"com/alibaba/japan/club/biz/dal/dao/clublog/dataobject/clublog-mapping.xml"</SPAN> /&gt;
    &lt;sqlMap resource=<SPAN class="code-quote">"com/alibaba/japan/club/biz/dal/dao/group/dataobject/usergroup-mapping.xml"</SPAN> /&gt;
    &lt;sqlMap resource=<SPAN class="code-quote">"com/alibaba/japan/club/biz/dal/dao/post/dataobject/post-mapping.xml"</SPAN> /&gt;
    &lt;sqlMap resource=<SPAN class="code-quote">"com/alibaba/japan/club/biz/dal/dao/report/dataobject/report-mapping.xml"</SPAN> /&gt;
    &lt;sqlMap resource=<SPAN class="code-quote">"com/alibaba/japan/club/biz/dal/dao/user/dataobject/user-mapping.xml"</SPAN> /&gt;
    &lt;sqlMap resource=<SPAN class="code-quote">"com/alibaba/japan/club/biz/dal/dao/resource/dataobject/resource-mapping.xml"</SPAN> /&gt;
    &lt;sqlMap resource=<SPAN class="code-quote">"com/alibaba/japan/club/biz/dal/dao/member/dataobject/member-mapping.xml"</SPAN> /&gt;
    &lt;sqlMap resource=<SPAN class="code-quote">"com/alibaba/japan/club/biz/dal/dao/company/dataobject/company-mapping.xml"</SPAN> /&gt;
    &lt;sqlMap resource=<SPAN class="code-quote">"com/alibaba/japan/club/biz/dal/dao/search/dataobject/keyword-mapping.xml"</SPAN> /&gt;
    &lt;sqlMap resource=<SPAN class="code-quote">"com/alibaba/japan/club/biz/dal/dao/timerjob/dataobject/timerjob-mapping.xml"</SPAN> /&gt;
    &lt;sqlMap resource=<SPAN class="code-quote">"com/alibaba/japan/club/biz/dal/dao/feedback/dataobject/feedback-mapping.xml"</SPAN> /&gt;
    &lt;sqlMap resource=<SPAN class="code-quote">"com/alibaba/japan/club/biz/dal/dao/sample/dataobject/sample-mapping.xml"</SPAN> /&gt;
    &lt;sqlMap resource=<SPAN class="code-quote">"com/alibaba/japan/club/biz/dal/dao/mail/dataobject/mail-mapping.xml"</SPAN> /&gt;
&lt;/sqlMapConfig&gt;</PRE>
</DIV></DIV>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. 下面为classpath:/biz/dal/spring/business-dao.xml的配置代码如下：</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">&lt;bean id=<SPAN class="code-quote">"daoConfigBase"</SPAN> <SPAN class="code-keyword">abstract</SPAN>=<SPAN class="code-quote">"<SPAN class="code-keyword">true</SPAN>"</SPAN>&gt;
    &lt;property name=<SPAN class="code-quote">"sqlMapClient"</SPAN>&gt;
        &lt;ref bean=<SPAN class="code-quote">"sqlMapClient"</SPAN> /&gt;
    &lt;/property&gt;
&lt;/bean&gt;
&lt;bean id=<SPAN class="code-quote">"typeDAO"</SPAN> class=<SPAN class="code-quote">"com.alibaba.japan.club.biz.dal.dao.type.impl.IbatisTypeDAO"</SPAN> parent=<SPAN class="code-quote">"daoConfigBase"</SPAN>&gt;
&lt;/bean&gt;</PRE>
</DIV></DIV>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color="#660000"><B>说明：</B></FONT>1. 首先，"sqlMapClient"元素定义了需要执行Ibatis框架工具类的工厂类，并导入了已经定义好的Ibatis相关配置文件"sqlmap-config.xml"。<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. 再次，"sqlmap-config.xml"文件里面引用了相关的Ibatis定义文件。<BR>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3. 最后，任何IbatisDAO类都要继承SqlMapClientDaoSupport类，并且在Spring容器中注册都要继续"daoConfigBase"配置；这样任何的DAO就都可以使用Ibaits配置文件中定义的SQL语句了。</P>
</DIV>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
    rdf:about="http://b2b-doc.alibaba-inc.com/pages/viewpage.action?pageId=31248781"
    dc:identifier="http://b2b-doc.alibaba-inc.com/pages/viewpage.action?pageId=31248781"
    dc:title="6. 其他配置文件"
    trackback:ping="http://b2b-doc.alibaba-inc.com/rpc/trackback/31248781"/>
</rdf:RDF>
-->
        

<!--
    Root decorator: all decisions about how a page is to be decorated via the
                    inline decoration begins here.
-->



<!--
    Switch based upon the context. However, for now, just delegate to a decorator
    identified directly by the context.
-->


    
    

<DIV class="wiki-content" style="margin-right:10px;">
    <P style="clear: both"><!-- comments should always display underneath the content. we should have a 'clear:both' here just in case there are floats or aligned images in the content -->

    
    
    
    
                                        </P><DIV style="margin-top: 30px;">
                <A href="http://b2b-doc.alibaba-inc.com/pages/viewpage.action?pageId=31248781&showComments=true&showCommentArea=true#addcomment"><IMG src="./6. 其他配置文件 - Confluence_files/add_comment_16.gif" height="16" width="16" border="0" align="absmiddle"></A>
                <A href="http://b2b-doc.alibaba-inc.com/pages/viewpage.action?pageId=31248781&showComments=true&showCommentArea=true#addcomment">Add Comment</A>
                </DIV>
                        </DIV>
                            </DIV>
                        </TD>
                            
    
        
    
                                                </TR>
                </TBODY></TABLE>
                <!-- End inner content table -->
            </TD>
        </TR>
    </TBODY></TABLE>
</DIV>
<DIV id="footer">
                                        <UL id="poweredby">
        <LI>Powered by <A href="http://www.atlassian.com/software/confluence" class="smalltext">Atlassian Confluence</A> 2.8.1, the <A href="http://www.atlassian.com/software/confluence" class="smalltext">Enterprise Wiki</A>.</LI>
        <LI><A href="http://jira.atlassian.com/secure/BrowseProject.jspa?id=10470" class="smalltext">Bug/feature request</A> –</LI>
        <LI><A href="http://www.atlassian.com/about/connected.jsp?s_kwcid=Confluence-stayintouch" class="smalltext">Atlassian news</A> –</LI>
        <LI><A href="http://b2b-doc.alibaba-inc.com/administrators.action">Contact administrators</A></LI>
    </UL>

    <!-- delay the loading of large javascript files to the end so that they don't interfere with the loading of page content -->
    <SPAN class="hidden scripts">
        <SCRIPT type="text/javascript">var domainName = 'http://b2b-doc.alibaba-inc.com'; var entityId = '31248781'; var spaceKey = 'jcbu'</SCRIPT>
        <SCRIPT type="text/javascript" src="./6. 其他配置文件 - Confluence_files/labels-javascript"></SCRIPT>
        <SCRIPT>new Ajax.Autocompleter('labelName', 'labelsAutocompleteList', '31248781', { tokens: new Array(',', ' '), dwrFunction: GenerateAutocompleteLabelsListForEntity.autocompleteLabels});</SCRIPT>
    </SPAN>
</DIV></BODY></HTML>